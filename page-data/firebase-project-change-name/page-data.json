{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/firebase-project-change-name","result":{"data":{"site":{"siteMetadata":{"title":"あのぞんブログ","author":"anozon","siteUrl":"https://blog.anozon.me"}},"markdownRemark":{"id":"f92e7142-b941-5b5b-86e7-e22cbb3be7d2","excerpt":"やること ソースコードの ID 変更 Firestore のデータ移行 やること プロジェクトの複製には、 移行先プロジェクト作成 ソースコードの ID 変更 移行元を Blaze Plan にする(なってない場合) Firestore のデータ移行 が必要になります。\nFirestore…","html":"<div class=\"toc\">\n<ul>\n<li><a href=\"#%E3%82%84%E3%82%8B%E3%81%93%E3%81%A8\">やること</a></li>\n<li><a href=\"#%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE-id-%E5%A4%89%E6%9B%B4\">ソースコードの ID 変更</a></li>\n<li><a href=\"#firestore-%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E7%A7%BB%E8%A1%8C\">Firestore のデータ移行</a></li>\n</ul>\n</div>\n<h2 id=\"やること\" style=\"position:relative;\">やること</h2>\n<p>プロジェクトの複製には、</p>\n<ul>\n<li>移行先プロジェクト作成</li>\n<li>ソースコードの ID 変更</li>\n<li>移行元を Blaze Plan にする(なってない場合)</li>\n<li>Firestore のデータ移行</li>\n</ul>\n<p>が必要になります。\nFirestore のデータ移行を中心にやってみた記録を残しておきます。</p>\n<h2 id=\"ソースコードの-id-変更\" style=\"position:relative;\">ソースコードの ID 変更</h2>\n<p>デプロイに関しては基本 <code class=\"language-text\">.firebaserc</code> を変えるだけで済みそう。</p>\n<h2 id=\"firestore-のデータ移行\" style=\"position:relative;\">Firestore のデータ移行</h2>\n<p>移行元のプロジェクト ID を <code class=\"language-text\">old_name</code>、新規プロジェクト ID を <code class=\"language-text\">new_name</code> として説明します。</p>\n<p><a href=\"https://firebase.google.com/docs/firestore/manage-data/export-import?hl=ja\">データのエクスポートとインポート  |  Firebase</a> にそって行います。</p>\n<p><a href=\"https://console.cloud.google.com/storage/browser\">ストレージ ブラウザ – Storage – scoreform – Google Cloud Platform</a> でデータ用のバケットを作成。</p>\n<p><code class=\"language-text\">gsutil のリンク</code> をメモします。\n(例: <code class=\"language-text\">gs://old_name-backup</code>)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 移行元プロジェクトに切り替え</span>\n$ gcloud config <span class=\"token builtin class-name\">set</span> project old_name\n<span class=\"token comment\"># Bucket に export する</span>\n$ gcloud firestore <span class=\"token builtin class-name\">export</span> gs://old_name-backup</code></pre></div>\n<p>export された フォルダ名をメモします。\n(例: <code class=\"language-text\">/2020-07-26T13:00:29_42888</code>)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># 新プロジェクト切り替え</span>\n$ gcloud config <span class=\"token builtin class-name\">set</span> project new_name\n\n<span class=\"token comment\"># new_name のサービスアカウントに bucket の権限付与</span>\n$ gsutil iam ch serviceAccount:<span class=\"token punctuation\">{</span>new project name<span class=\"token punctuation\">}</span>@appspot.gserviceaccount.com:admin gs://old_name-backup\n\n<span class=\"token comment\"># Bucket から 新Firestore に import</span>\n$ gcloud firestore <span class=\"token function\">import</span> gs://old_name-backup/2020-07-26T13:00:29_42888</code></pre></div>\n<p>以上の手順で移行できました。</p>\n<p>移行元と移行先の Firestore で region が違う場合は、import 時か export 時にエラーが出てしまいます。\nその場合、2 つの region の Bucket を用意してデータを移動することで import できることも確認できました。</p>","frontmatter":{"title":"Firebase Project の複製や ID 変更","date":"2020-07-26","tags":["Firebase","GCP"]}}},"pageContext":{"slug":"firebase-project-change-name","previous":{"excerpt":"Markdown の複数行コードブロックは普通以下のように書きます。 その中にを書くときは  を使います。 ※この記事はマークダウンで書いているので更に  で囲っています。（コード elzup/anozonbiyori@a7d62e…","fields":{"slug":"markdown-escape-backquote"},"frontmatter":{"title":"Markdown でコードブロックの中にバックスラッシュ3つを書く"}},"next":null}}}