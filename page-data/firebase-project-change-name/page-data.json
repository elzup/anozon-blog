{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/firebase-project-change-name","result":{"data":{"site":{"siteMetadata":{"title":"あのぞんブログ","author":"anozon","siteUrl":"https://blog.anozon.me"}},"markdownRemark":{"id":"50876599-e912-5799-8a27-d0cebc3a445f","excerpt":"やること プロジェクトの複製には、 移行先プロジェクト作成 ソースコードの ID 変更 移行元を Blaze Plan にする(なってない場合) Firestore のデータ移行 が必要になります。\nFirestore のデータ移行を中心にやってみた記録を残しておきます。 ソースコードの ID…","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"やること"},"children":[{"type":"text","value":"やること"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"プロジェクトの複製には、"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"移行先プロジェクト作成"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"ソースコードの ID 変更"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"移行元を Blaze Plan にする(なってない場合)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Firestore のデータ移行"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"が必要になります。\nFirestore のデータ移行を中心にやってみた記録を残しておきます。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"ソースコードの-id-変更"},"children":[{"type":"text","value":"ソースコードの ID 変更"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"デプロイに関しては基本 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".firebaserc"}]},{"type":"text","value":" を変えるだけで済みそう。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"firestore-のデータ移行"},"children":[{"type":"text","value":"Firestore のデータ移行"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"移行元のプロジェクト ID を "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"old_name"}]},{"type":"text","value":"、新規プロジェクト ID を "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"new_name"}]},{"type":"text","value":" として説明します。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://firebase.google.com/docs/firestore/manage-data/export-import?hl=ja"},"children":[{"type":"text","value":"データのエクスポートとインポート  |  Firebase"}]},{"type":"text","value":" にそって行います。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://console.cloud.google.com/storage/browser"},"children":[{"type":"text","value":"ストレージ ブラウザ – Storage – scoreform – Google Cloud Platform"}]},{"type":"text","value":" でデータ用のバケットを作成。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"gsutil のリンク"}]},{"type":"text","value":" をメモします。\n(例: "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"gs://old_name-backup"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 移行元プロジェクトに切り替え"}]},{"type":"text","value":"\n$ gcloud config "},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"set"}]},{"type":"text","value":" project old_name\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Bucket に export する"}]},{"type":"text","value":"\n$ gcloud firestore "},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" gs://old_name-backup"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"export された フォルダ名をメモします。\n(例: "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/2020-07-26T13:00:29_42888"}]},{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"bash"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-bash"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# 新プロジェクト切り替え"}]},{"type":"text","value":"\n$ gcloud config "},{"type":"element","tagName":"span","properties":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"set"}]},{"type":"text","value":" project new_name\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# new_name のサービスアカウントに bucket の権限付与"}]},{"type":"text","value":"\n$ gsutil iam ch serviceAccount:"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"new project name"},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"@appspot.gserviceaccount.com:admin gs://old_name-backup\n\n"},{"type":"element","tagName":"span","properties":{"className":["token","comment"]},"children":[{"type":"text","value":"# Bucket から 新Firestore に import"}]},{"type":"text","value":"\n$ gcloud firestore "},{"type":"element","tagName":"span","properties":{"className":["token","function"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" gs://old_name-backup/2020-07-26T13:00:29_42888"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"以上の手順で移行できました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"移行元と移行先の Firestore で region が違う場合は、import 時か export 時にエラーが出てしまいます。\nその場合、2 つの region の Bucket を用意してデータを移動することで import できることも確認できました。"}]}],"data":{"quirksMode":false}},"frontmatter":{"title":"Firebase Project の複製や ID 変更","date":"2020-07-26","topics":["Firebase","GCP"]}}},"pageContext":{"slug":"firebase-project-change-name","previous":{"excerpt":"Markdown の複数行コードブロックは普通以下のように書きます。 その中にを書くときは  を使います。 ※この記事はマークダウンで書いているので更に  で囲っています。（コード elzup/anozonbiyori@a7d62e…","fields":{"slug":"markdown-escape-backquote"},"frontmatter":{"title":"Markdown でコードブロックの中にバックスラッシュ3つを書く"}},"next":{"excerpt":"elzup (elzup)\n shields.io を使って技術系アイコンを量産した - Qiita を参考に Badge を作りました。 Shields.io の logo 機能 Shields.io: Quality metadata badges for open…","fields":{"slug":"github-profile-shields"},"frontmatter":{"title":"GitHub Profile README に Shields.io Badge並べた"}}}},"staticQueryHashes":["1855083372","2529228376","3857661231"]}