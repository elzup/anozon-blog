{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/gh-pages-redirect","result":{"data":{"site":{"siteMetadata":{"title":"あのぞんブログ","author":"anozon","siteUrl":"https://blog.anozon.me"}},"markdownRemark":{"id":"cc6e911b-c9f0-5a48-870e-523238e81103","excerpt":"概要 gh-pages ブランチをクリーンにする jekyll でリダイレクトする 概要 GitHub Pages から別のホスティングへ移行したとき、\nドメインが変わる場合にすべき設定について。 運用していたページ  へのアクセスを 新しい URL へリダイレクトする必要があります。 gh-pages…","html":"<div class=\"toc\">\n<ul>\n<li><a href=\"#%E6%A6%82%E8%A6%81\">概要</a></li>\n<li><a href=\"#gh-pages-%E3%83%96%E3%83%A9%E3%83%B3%E3%83%81%E3%82%92%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%81%AB%E3%81%99%E3%82%8B\">gh-pages ブランチをクリーンにする</a></li>\n<li><a href=\"#jekyll-%E3%81%A7%E3%83%AA%E3%83%80%E3%82%A4%E3%83%AC%E3%82%AF%E3%83%88%E3%81%99%E3%82%8B\">jekyll でリダイレクトする</a></li>\n</ul>\n</div>\n<h2 id=\"概要\" style=\"position:relative;\">概要</h2>\n<p>GitHub Pages から別のホスティングへ移行したとき、\nドメインが変わる場合にすべき設定について。</p>\n<p>運用していたページ <code class=\"language-text\">https://[user].github.io/[repo]</code> へのアクセスを <strong>新しい URL へリダイレクトする必要があります。</strong></p>\n<h2 id=\"gh-pages-ブランチをクリーンにする\" style=\"position:relative;\">gh-pages ブランチをクリーンにする</h2>\n<p>すでにビルドされたファイルなどがある場合は削除します。</p>\n<h2 id=\"jekyll-でリダイレクトする\" style=\"position:relative;\">jekyll でリダイレクトする</h2>\n<p>サンプルの gh-pages ブランチ\n<a href=\"https://github.com/elzup/dentime/tree/gh-pages\">elzup/dentime at gh-pages</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">_layouts/\n  redirected.html\n404.html\nGemfile\nGemfile.lock\n_config.yml\nindex.md</code></pre></div>\n<p>プロジェクト構造は以上のようになります。各ファイルは <a href=\"https://github.com/elzup/dentime/tree/gh-pages\">サンプル</a>を見てください。</p>\n<p><code class=\"language-text\">index.md</code> と <code class=\"language-text\">404.html</code> を以下のように書きかえます。</p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token hr punctuation\">---</span>\nlayout: redirected\nsitemap: false\n<span class=\"token title important\">redirect_to: &lt;新しいURL>\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p><code class=\"language-text\">redirect_to</code> に新しい URL (リダイレクト先) を指定します。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>_config.yml</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> jekyll<span class=\"token punctuation\">-</span>redirect<span class=\"token punctuation\">-</span>from</code></pre></div>\n\n        <div class=\"gatsby-code-title\">\n          <span>_layouts/redirected.html</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>canonical<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{ page.redirect_to }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>content-type<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/html; charset=utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>refresh<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0;url={{ page.redirect_to }}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Redirecting...<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{{ page.redirect_to }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Click here if you are not redirected.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">location<span class=\"token operator\">=</span><span class=\"token string\">'{{ page.redirect_to }}'</span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">&lt;link rel=&quot;canonical&quot; href=&quot;URL&quot;</code> : 正規化設定</li>\n<li><code class=\"language-text\">&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;url=URL&quot;</code> : 0 秒で URL にリダイレクト</li>\n<li>javascript で(も？) <code class=\"language-text\">location = &#39;URL&#39;</code> によりページ遷移</li>\n<li>遷移しなかった場合のリンクとナビゲーションメッセージのレンダリング</li>\n</ul>\n<p>を行っています。</p>","frontmatter":{"title":"GitHub Pages から別のサイトに移行するときのリダイレクト設定","date":"2020-04-30","tags":["GitHub Pages"]}}},"pageContext":{"slug":"gh-pages-redirect","previous":{"excerpt":"この記事では rel=noopener”をつけないとどんなことができるのかをデモで示します。 noopener の攻撃デモ 攻撃サイト側のコード noopener の攻撃デモ リンク: https://tools.anozon.me/noopener noopener…","fields":{"slug":"danger-of-noopener"},"frontmatter":{"title":"rel=noopenerをつけないサイトへの攻撃デモ"}},"next":{"excerpt":".env ファイルを使う docker-compose.yml .env ファイルを使う サンプルコード: elzup-sandbox/docker-scratch docker-compose.yml services.shell.environment…","fields":{"slug":"docker-compose-by-env"},"frontmatter":{"title":"docker-compose.yml に環境変数を渡す"}}}},"staticQueryHashes":["1855083372","3070792728","4156694545"]}