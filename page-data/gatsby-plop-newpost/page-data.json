{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/gatsby-plop-newpost","result":{"data":{"site":{"siteMetadata":{"title":"あのぞんブログ","author":"anozon"}},"markdownRemark":{"id":"0e346e5b-12ba-5211-870d-f843c786565d","excerpt":"この記事では PLOP について紹介します。\nGatsbyJS で書いている当ブログの記事作成を例に話します。 Consistency Made Simple : PLOP 手順 1. インストール npm で global インストールだと何故か動かなかった。\nプロジェクト依存で入れた。 手順…","html":"<p>この記事では PLOP について紹介します。\nGatsbyJS で書いている当ブログの記事作成を例に話します。</p>\n<p><a href=\"https://plopjs.com/\">Consistency Made Simple : PLOP</a></p>\n<h2>手順 1. インストール</h2>\n<p>npm で global インストールだと何故か動かなかった。\nプロジェクト依存で入れた。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn add plop -D</code></pre></div>\n<h2>手順 2. テンプレートを作る</h2>\n<p>記事のテンプレートを用意します。\nmarkdown でメタ情報含めて定義しました。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>post.hbs</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\ntitle: {{title}}\ndate: {{date}} {{hms}}\ntags:\n- a\n- b\ncategory: {{category}}\n---\n\nこの記事では {{title}} について紹介します。</code></pre></div>\n<p><code class=\"language-text\">{{variable}}</code> で変数を定義します。</p>\n<h2>手順 3. plopfile.js を作る</h2>\n<p>ファイルを生成する設定を書きます。</p>\n<p><strong>テンプレートで必要となる変数</strong>, <strong>ファイルのパス</strong>が揃うように作ります。</p>\n\n        <div class=\"gatsby-code-title\">\n          <span>propfile.js</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">pad00</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">num</span> <span class=\"token operator\">=></span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> year <span class=\"token operator\">=</span> date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> month <span class=\"token operator\">=</span> <span class=\"token function\">pad00</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> day <span class=\"token operator\">=</span> <span class=\"token function\">pad00</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> hms <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">pad00</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:00:00</span><span class=\"token template-punctuation string\">`</span></span>\n<span class=\"token keyword\">const</span> datePrefix <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>year<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>month<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>day<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token keyword\">const</span> categories <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Other'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Tech'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BlogOps'</span><span class=\"token punctuation\">]</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">/** @type {import('plop').NodePlopAPI} */</span>\n  plop\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  plop<span class=\"token punctuation\">.</span><span class=\"token function\">setHelper</span><span class=\"token punctuation\">(</span><span class=\"token string\">'getKebabFirst'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">date</span> <span class=\"token operator\">=></span> date<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  plop<span class=\"token punctuation\">.</span><span class=\"token function\">setHelper</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hms'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> hms<span class=\"token punctuation\">)</span>\n  plop<span class=\"token punctuation\">.</span><span class=\"token function\">setGenerator</span><span class=\"token punctuation\">(</span><span class=\"token string\">'post'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    description<span class=\"token operator\">:</span> <span class=\"token string\">'Write new blog post'</span><span class=\"token punctuation\">,</span>\n    prompts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'title'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> message<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">kebab-case</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'date'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> datePrefix<span class=\"token punctuation\">,</span>\n        message<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">YYYY-MM-DD</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">'list'</span><span class=\"token punctuation\">,</span>\n        name<span class=\"token operator\">:</span> <span class=\"token string\">'category'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token string\">'Tech'</span><span class=\"token punctuation\">,</span>\n        choices<span class=\"token operator\">:</span> categories<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    actions<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">'add'</span><span class=\"token punctuation\">,</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">content/blog/{{getKebabFirst date}}/{{date}}___{{id}}.md</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        templateFile<span class=\"token operator\">:</span> <span class=\"token string\">'templates/post.hbs'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 自分のテンプレートがある path</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上記のコードによって、</p>\n<p>title は入力して設定、\nid (slug, ファイルのパスに必要)も入力して設定、</p>\n<p>category は選択して設定、</p>\n<p>ファイルのパスやタイムスタンプはデフォルトで自動生成するようになります。</p>\n<p>質問の <code class=\"language-text\">type</code> は <a href=\"https://github.com/SBoudrias/Inquirer.js\">Inquirer.js:</a> の中から使えます。</p>\n<p><a href=\"https://github.com/SBoudrias/Inquirer.js\">SBoudrias/Inquirer.js: A collection of common interactive command line user interfaces.</a></p>\n<h2>手順 4. 実行してみる</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">yarn plop</code></pre></div>\n<p><img src=\"https://elzup-image-storage.s3.amazonaws.com/blog/gatsby-plop-example.png\" alt=\"plop example\"></p>\n\n        <div class=\"gatsby-code-title\">\n          <span>content/blog/2020/2020-01-13___gatsby-plop-newpost.md</span>\n        </div>\n       \n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\ntitle: 【PLOP】GatsbyJSで新しい記事をテンプレートから作成する\ndate: 2020-01-13 20:00:00\ntags:\n- a\n- b\ncategory: BlogOps\n---\n\nこの記事では 【PLOP】GatsbyJSで新しい記事をテンプレートから作成する について紹介します。\n\n## 手順 1. 初期化する\n\n## 手順 2. リクエストを定義する\n\n## xx の場合</code></pre></div>\n<p>目的のファイルが目的のパスに生成されました！</p>\n<h2>感想</h2>\n<p>今回はテンプレートからファイル生成ということでシンプルに需要ありそうですが、そういうツール聞いたこと無いなと思って探してみて見つけたものでした。</p>\n<p>最初”file template generator cli” などでググってなかなか見つからずに自分で shell と sed で実装しようとしました。\nしかし、<a href=\"https://github.com/react-boilerplate/react-boilerplate\">react-boilerplate/react-boilerplate</a> で generator がついてたのを思い出して何が使われているのか調べたところ <code class=\"language-text\">plop</code> にたどり着きました。</p>\n<p>もちろん他にも使えそうで良いものを見つけた。</p>","frontmatter":{"title":"【PLOP CLI】新しいファイルをテンプレートから生成するCLI","date":"2020-01-12 00:00:00","tags":["PLOP","Node.js","CLI","gatsby"]}}},"pageContext":{"slug":"gatsby-plop-newpost","previous":{"fields":{"slug":"gatsby-to-typescript"},"frontmatter":{"title":"GatsbyJS を Typescript に移行した際の Type 付け"}},"next":{"fields":{"slug":"layer-react-counterapp"},"frontmatter":{"title":"5層 ReactComponent と TypeScript でカウンター書いてみる"}}}}}