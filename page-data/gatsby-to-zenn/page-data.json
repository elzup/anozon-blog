{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/gatsby-to-zenn","result":{"data":{"site":{"siteMetadata":{"title":"あのぞんブログ","author":"anozon","siteUrl":"https://blog.anozon.me"}},"markdownRemark":{"id":"8466fbd9-0c25-5241-9a1d-708232c2ffcc","excerpt":"Zenn に対応する 個人ブログ(Gatsby のブログ)から Zenn にマルチポストする設定をしました。  は Zenn に向けています。 週 1 以上書くというペースを心がけて気づいたら 91 記事も書いていました。\nZenn エディタやフォーマットの恩恵や Zenn…","htmlAst":{"type":"root","children":[{"type":"element","tagName":"h2","properties":{"id":"zenn-に対応する"},"children":[{"type":"text","value":"Zenn に対応する"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"個人ブログ(Gatsby のブログ)から Zenn にマルチポストする設定をしました。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"canonical_url"}]},{"type":"text","value":" は Zenn に向けています。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"週 1 以上書くというペースを心がけて気づいたら 91 記事も書いていました。\nZenn エディタやフォーマットの恩恵や Zenn でのフィードバックを受けて記事を書くモチベをさらにあげたいです。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://zenn.dev/zenn/articles/connect-to-github"},"children":[{"type":"text","value":"公式の記事"}]},{"type":"text","value":"にもあるように Zenn で用意されている GitHub 連携できるような構造、マークダウンやファイル名に対応していきます。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"デプロイ設定エクスポート処理"},"children":[{"type":"text","value":"デプロイ設定(エクスポート処理)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"現在のファイル構造は変えずにエクスポートをして GitHub Actions で zenn 用ブランチに push します。\nZenn 側での設定はほぼボタン 1 つでできるので省きます。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ディレクトリ位置"},"children":[{"type":"text","value":"ディレクトリ位置"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"現在の記事の位置は以下のパスにあります。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"./content/blog/2021/2021-09-18___blog-title.md"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Zenn では以下の構造に決まっています。 "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zen-cli"}]},{"type":"text","value":" で "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zen-init"}]},{"type":"text","value":" して生成されます。とてもシンプルです。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/articles\n/books"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/out_zenn"}]},{"type":"text","value":" ディレクトリをルートとして一旦エクスポートします。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/content/blog/**/*-slug.md"}]},{"type":"text","value":" を "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"/out_zenn/articles/slug.md"}]},{"type":"text","value":" にコピーするスクリプトを作成しました。\nコード "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/elzup/anozon-blog/blob/master/export_zenn.js"},"children":[{"type":"text","value":"anozon-blog/export_zenn.js at master · elzup/anozon-blog"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"シェルスクリプトでもできそうだったんですが、拡張できるように node で書きました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"out_zenn で "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"zenn preview"}]},{"type":"text","value":" するとしっかり表示されました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://storage.googleapis.com/zenn-user-upload/05b92b12eaa86fb01165a5f3.png","alt":"zenn-local-preview"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"zenn-export-github-actions-作成"},"children":[{"type":"text","value":"Zenn export GitHub Actions 作成"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"GitHub Actions で特定のブランチに commit するには "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/s0/git-publish-subdir-action"},"children":[{"type":"text","value":"s0/git-publish-subdir-action"}]},{"type":"text","value":" が便利でした。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"packages.json に scripts 追加"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"title=packages.json"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-title=packages.json"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-title=packages.json"]},"children":[{"type":"text","value":"  \"scripts\": {\n    \"zenn:export\": \"node export_zenn.js\",\n  }"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":".github/workflows/zenn.yml"}]},{"type":"text","value":" を作成します。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"ymltitle=zenn.yml"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-ymltitle=zenn.yml"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-ymltitle=zenn.yml"]},"children":[{"type":"text","value":"# 省略\nsteps:\n  - uses: actions/checkout@master\n  - uses: actions/setup-node@v2\n    with:\n      node-version: ${{ matrix.node-version }}\n  - name: Push to build branch\n    uses: s0/git-publish-subdir-action@master\n    env:\n      REPO: self\n      BRANCH: zenn\n      FOLDER: out_zenn\n      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"zenn-のファイルフォーマットに修正する"},"children":[{"type":"text","value":"Zenn のファイルフォーマットに修正する"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"preview で記事を開くとエラがー出たので対応します。わかりやすくてとても助かる 😎。\n"},{"type":"element","tagName":"img","properties":{"src":"https://storage.googleapis.com/zenn-user-upload/d51953a7fa3ab46d65881541.png","alt":"zenn-error"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"markdown-メタデータを対応する"},"children":[{"type":"text","value":"Markdown メタデータを対応する"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"既存の命名にこだわりもないので Zenn で使われているキーワードに全部移行する。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"topics-published-type-対応"},"children":[{"type":"text","value":"topics, published, type 対応"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"topics"}]},{"type":"text","value":" -> "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"topics"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"status: draft"}]},{"type":"text","value":" -> "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"published: false"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"type: tech"}]},{"type":"text","value":" を追加"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"追加メタは正規表現で一括置き換えした。\ns/"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"( -.*\\n)---"}]},{"type":"text","value":"/"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"$1type: tech\\npublished: true\\n---"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"img","properties":{"src":"https://storage.googleapis.com/zenn-user-upload/82781151e7b0135692c824b5.png","alt":"zenn-add-tag"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Gatsby 側のコードに関わる部分も対応が必要です。"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"topics"}]},{"type":"text","value":" や "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"status"}]},{"type":"text","value":" など対応しました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"emoji-追加"},"children":[{"type":"text","value":"emoji 追加"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"お気に入りの記事だけ設定した。オプショナルでランダムな(ハッシュから？)絵文字を設定してくれる。\nランダムでもそれっぽくなる。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"短すぎる-slug-の修正"},"children":[{"type":"text","value":"短すぎる slug の修正"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"slug (ファイル名のキーワード) を"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"12 文字〜50 文字"}]},{"type":"text","value":" に対応します。\n12 文字より短いのがあったので修正した。ちょっと大変だった。\nこだわってつけていたわけじゃないから命名は楽だった。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"topics-の記号禁止対応"},"children":[{"type":"text","value":"topics の記号禁止対応"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Zenn 側では登録されている Toipcs タグの表示はアイコンやラベルがマッピングされます。\n既存記事ではスペースやドットなど記号込みでつけていたので修正しました。\n(そもそもメタデータ記法として正しいのかわからないまま記号入りで書いていました。)\n大小文字は対応してくれている優しさを感じる。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"markdown-本文修正"},"children":[{"type":"text","value":"Markdown 本文修正"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"diff-タイプのコードブロック対応"},"children":[{"type":"text","value":"diff タイプのコードブロック対応"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"なぜか diff タイプのコードブロックがうまく動きませんでした。\nJSON parse Error みたいなのが出てしまいました。\n"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"```diff.*"}]},{"type":"text","value":" を "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"```"}]},{"type":"text","value":" に置き換えて対応しました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"目次gatsby-remark-table-of-contents-を削除する"},"children":[{"type":"text","value":"目次(gatsby-remark-table-of-contents) を削除する"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"目次に"},{"type":"element","tagName":"a","properties":{"href":"https://www.gatsbyjs.com/plugins/gatsby-remark-table-of-contents/"},"children":[{"type":"text","value":"gatsby-remark-table-of-contents | Gatsby"}]},{"type":"text","value":" を使っていました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"```toc\n# This code block gets replaced with the TOC\n```"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"目次つけたい記事内に毎回これを挿入する必要があってイケてないので削除しました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"canonical-url"},"children":[{"type":"text","value":"canonical url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.gatsbyjs.com/plugins/gatsby-plugin-react-helmet-canonical-urls/?=canonical%20url"},"children":[{"type":"text","value":"gatsby-plugin-react-helmet-canonical-urls | Gatsby"}]},{"type":"text","value":" を使って設定しました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://www.gatsbyjs.com/plugins/gatsby-plugin-canonical-urls/?=canonical%20url"},"children":[{"type":"text","value":"gatsby-plugin-canonical-urls"}]},{"type":"text","value":" も試したんですが、パスを含む siteUrl に対応できなかったので("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"https://zenn.dev/slug"}]},{"type":"text","value":" になってしまう)やめました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"対応完了-"},"children":[{"type":"text","value":"対応完了 🎉"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"91 記事インポートできました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://storage.googleapis.com/zenn-user-upload/fd657c1252f2bccc00a428ed.png"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"その他後回しにしてる部分"},"children":[{"type":"text","value":"その他後回しにしてる部分"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"記事タイトルをに"},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"【JavaScript】"}]},{"type":"text","value":" みたいなのいれてるのを外す。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"コードブロックの title 対応"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"gatsby に依存しているため "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"```js title=hoge.js"}]},{"type":"text","value":" っていう微妙なフォーマットになっている。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"zenn-cli-preview-編集関係"},"children":[{"type":"text","value":"Zenn cli preview 編集関係"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Zenn でのプレビューは npm scripts に追加すると "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"yarn zen"}]},{"type":"text","value":" ですぐ見れます。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"title=package.json"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-title=package.json"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-title=package.json"]},"children":[{"type":"text","value":"    \"zenn\": \"yarn zenn:export && (cd out_zenn && npx zenn)\","}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h4","properties":{"id":"vscode-plugin-zenn-editor-を使えるようにする"},"children":[{"type":"text","value":"VSCode Plugin Zenn Editor を使えるようにする"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://storage.googleapis.com/zenn-user-upload/29ce0451c3310c2499d1f49c.png","alt":"vscode-zenn-editor"},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"articles, books ディレクトリの構造がないと使えないためシンボリックリンクで実現しました。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"text"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-text"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"mkdir zenn_tmp\nln -s ../content/blog/2021/ ./articles\ncode zenn_tmp"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"マークダウンがどう表示されるのか気になって試したけど、今後は使うこと無い(かも)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"ちょっと困ったこと"},"children":[{"type":"text","value":"ちょっと困ったこと"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"現状 GitHub 連携してしまうと Zenn web での執筆 UI がどんなものなのか試せませんでした。\nbooks だけ web で書きたさがあったりします。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"感想"},"children":[{"type":"text","value":"感想"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"基本今までイマイチだなあと思っていた仕様を対応する形になったので良かったです。\nzen の ローカル preview のエラーがめっちゃわかりやすくてリッチな体験でした。"}]}],"data":{"quirksMode":false}},"frontmatter":{"title":"Gatsby のブログを Zenn に連携する","date":"2021-09-18","topics":["Markdown","Gatsby","Zenn"]}}},"pageContext":{"slug":"gatsby-to-zenn","previous":{"excerpt":"エディタなどによってうまくハイライトされなかったときはこうする。 をにする。","fields":{"slug":"arrow-function-generics"},"frontmatter":{"title":"Arrow function で generics にすると HTML タグとして認識されてしまうときの tips"}},"next":null}},"staticQueryHashes":["2529228376","3857661231","733094525"]}